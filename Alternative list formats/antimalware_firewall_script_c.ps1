Write-Host "PowerShell script for blocking malicious IPs in Windows Firewall"
Write-Host "Created by iam-py-test"
Write-Host "This must be run as admin and on Microsoft Windows 10/11 or else it will not work!"

Write-Host "Removing old rules"
Get-NetFirewallRule -DisplayName "iam-py-test - Block outbound connections to this ip" -ErrorAction SilentlyContinue | Remove-NetFirewallRule
Get-NetFirewallRule -DisplayName "iam-py-test - Block inbound connections from this ip" -ErrorAction SilentlyContinue | Remove-NetFirewallRule

Write-Host "Adding new rules"
New-NetFirewallRule -DisplayName "iam-py-test - Block outbound connections to this ip" -Direction outbound -LocalPort Any -Protocol tcp -Action Block -RemoteAddress 91.241.60.117,37.1.209.213,185.220.35.26,188.225.75.54,185.220.33.3,185.230.140.210,188.227.107.121,188.227.107.92,77.91.102.23,35.236.159.79,104.155.207.188,45.227.254.52,31.44.6.123,85.31.46.80,95.214.53.31,58.252.203.71,185.216.71.149,116.202.5.101,193.106.191.160,88.198.106.9,95.217.31.208,139.45.197.239,185.234.247.238,45.15.157.132,209.209.41.33,194.58.108.112,142.93.198.232,116.203.121.167,157.230.87.146,77.73.134.24,65.108.249.43,51.68.154.128,116.203.3.152,143.198.211.93,5.75.173.242,44.236.213.34,52.24.156.12,52.25.6.134,100.20.13.49,88.119.161.188,88.119.161.19,68.60.77.128,146.70.86.11,69.46.15.158,79.137.206.138,194.36.177.164,135.181.41.147,82.115.223.46,35.181.110.225,194.87.216.194,62.204.41.176,176.113.115.177,79.137.248.136,79.137.206.31,85.192.40.253,83.217.11.27,77.73.134.35,83.217.11.28,176.57.150.117,95.217.14.200,46.48.76.120,3.231.116.86,54.237.193.255,162.243.164.175,108.61.242.65,146.70.78.43,87.120.254.39,45.150.108.213,92.204.160.240,45.15.157.131,139.224.13.184,37.220.87.68,87.121.221.106,37.220.87.66,45.9.74.99,195.123.227.138,185.209.161.89,79.137.202.161,78.46.248.198,78.47.9.120,162.55.212.236,45.159.189.105,65.21.240.228,5.42.66.3,45.15.159.27,208.67.104.60,167.86.74.95,213.255.247.174,5.42.86.86,77.105.147.158,185.106.93.193,193.27.90.10,5.75.211.167,62.182.156.148,95.216.94.138,85.208.139.35,95.216.94.138,194.169.175.93,168.119.178.159,45.9.74.141,45.9.74.166,168.119.51.197,24.199.69.78,49.13.60.242,178.20.47.114,194.180.48.100,2.56.59.215,212.192.241.72,154.223.16.114,109.230.199.181,185.141.63.172,193.242.211.141,212.8.242.211,109.236.85.145,190.2.135.77,151.80.38.159,217.23.6.51,217.23.9.168,37.187.122.227,51.159.66.125,109.236.88.134,109.236.81.104,176.31.254.229,185.141.63.2,185.141.63.4,185.141.63.84,185.141.63.85,188.165.192.126,188.165.192.18,188.165.195.130,195.154.174.130,195.154.176.206,195.154.176.209,195.154.178.238,195.154.188.211,195.154.235.51,195.154.241.165,195.154.242.37,195.154.243.38,195.154.251.21,195.154.251.99,195.154.252.221,195.154.253.49,37.187.142.187,37.187.143.172,37.187.148.204,62.210.204.131,88.80.145.110,88.80.145.142,88.80.147.200,88.80.147.205,88.80.147.36,88.80.148.219,88.80.148.33,88.80.148.8,91.121.171.208,91.92.111.131,91.92.111.132,91.92.111.133,91.121.30.185,94.23.58.173,217.23.5.14,94.131.111.240,81.177.136.179,74.119.192.188,185.196.9.161,49.13.94.153,213.248.43.54,67.217.57.54,89.190.156.180,34.74.68.195,104.194.130.185,109.234.156.180,128.140.123.187,149.248.76.158,152.89.198.77,193.106.175.11,195.85.115.195,212.193.48.80,213.227.154.170,217.12.206.218,45.129.14.157,45.143.136.123,45.144.28.76,45.87.154.158,78.24.222.162,85.208.107.228,91.203.193.162,194.26.135.180,121.37.215.155,91.215.85.23,89.23.98.92,89.23.96.177,91.215.85.23,158.160.5.182,185.215.113.66,195.35.19.138,34.195.224.242,54.225.185.110,193.233.193.65,176.123.11.26,141.11.178.3,91.199.133.104,193.17.183.123,95.216.253.55,45.141.87.216,172.233.228.93,144.172.79.92,66.235.168.222,110.47.250.103,126.227.76.24,38.207.148.123,147.45.70.100,199.119.206.28,38.181.70.3,149.28.194.95,78.141.232.174,38.180.128.159,64.176.226.203,38.180.106.167,173.255.223.159,38.60.218.153,185.108.105.110,146.70.192.174,149.88.27.212,154.223.16.34,38.180.41.251,203.160.86.91,45.121.51.2,4.228.216.231,104.223.91.28,198.54.135.99,184.147.100.29,146.70.117.210,198.54.130.153,169.150.203.22,185.156.46.163,146.70.171.99,206.217.206.108,45.86.221.146,193.32.126.233,87.249.134.11,66.115.189.247,104.129.24.124,146.70.171.112,198.54.135.67,146.70.124.216,45.134.142.200,206.217.205.49,146.70.117.56,169.150.201.25,66.63.167.147,194.230.144.126,146.70.165.227,154.47.30.137,154.47.30.150,96.44.191.140,146.70.166.176,198.44.136.56,176.123.6.193,192.252.212.60,173.44.63.112,37.19.210.34,37.19.210.21,185.213.155.241,198.44.136.82,93.115.0.49,204.152.216.105,198.44.129.82,185.248.85.59,198.54.131.152,102.165.16.161,185.156.46.144,45.134.140.144,198.54.135.35,176.123.3.132,185.248.85.14,169.150.223.208,162.33.177.32,194.230.145.67,5.47.87.202,194.230.160.5,194.230.147.127,176.220.186.152,194.230.160.237,194.230.158.178,194.230.145.76,45.155.91.99,194.230.158.107,194.230.148.99,194.230.144.50,185.204.1.178,79.127.217.44,104.129.24.115,146.70.119.24,138.199.34.144,185.248.85.14,94.156.79.8,79.137.192.4,62.138.18.13,43.156.237.181,45.207.168.120,185.81.115.28,79.137.197.154,91.215.85.223,45.9.74.36,147.45.47.37,77.221.156.10,83.217.208.37,129.226.206.133,129.226.206.133,103.224.182.251,204.11.56.48,37.187.88.137,54.37.5.34,132.226.203.60,51.68.87.229,185.155.184.98,157.230.4.182,37.1.213.100,85.192.63.194,94.142.138.131,185.246.188.124,185.246.188.125,194.63.140.103,194.63.143.61,194.63.143.96,47.251.77.252,185.106.94.223,34.117.171.15,23.111.31.137,23.111.88.207,147.135.253.55
New-NetFirewallRule -DisplayName "iam-py-test - Block inbound connections from this ip" -Direction Inbound -LocalPort Any -Protocol tcp -Action Block -RemoteAddress 91.241.60.117,37.1.209.213,185.220.35.26,188.225.75.54,185.220.33.3,185.230.140.210,188.227.107.121,188.227.107.92,77.91.102.23,35.236.159.79,104.155.207.188,45.227.254.52,31.44.6.123,85.31.46.80,95.214.53.31,58.252.203.71,185.216.71.149,116.202.5.101,193.106.191.160,88.198.106.9,95.217.31.208,139.45.197.239,185.234.247.238,45.15.157.132,209.209.41.33,194.58.108.112,142.93.198.232,116.203.121.167,157.230.87.146,77.73.134.24,65.108.249.43,51.68.154.128,116.203.3.152,143.198.211.93,5.75.173.242,44.236.213.34,52.24.156.12,52.25.6.134,100.20.13.49,88.119.161.188,88.119.161.19,68.60.77.128,146.70.86.11,69.46.15.158,79.137.206.138,194.36.177.164,135.181.41.147,82.115.223.46,35.181.110.225,194.87.216.194,62.204.41.176,176.113.115.177,79.137.248.136,79.137.206.31,85.192.40.253,83.217.11.27,77.73.134.35,83.217.11.28,176.57.150.117,95.217.14.200,46.48.76.120,3.231.116.86,54.237.193.255,162.243.164.175,108.61.242.65,146.70.78.43,87.120.254.39,45.150.108.213,92.204.160.240,45.15.157.131,139.224.13.184,37.220.87.68,87.121.221.106,37.220.87.66,45.9.74.99,195.123.227.138,185.209.161.89,79.137.202.161,78.46.248.198,78.47.9.120,162.55.212.236,45.159.189.105,65.21.240.228,5.42.66.3,45.15.159.27,208.67.104.60,167.86.74.95,213.255.247.174,5.42.86.86,77.105.147.158,185.106.93.193,193.27.90.10,5.75.211.167,62.182.156.148,95.216.94.138,85.208.139.35,95.216.94.138,194.169.175.93,168.119.178.159,45.9.74.141,45.9.74.166,168.119.51.197,24.199.69.78,49.13.60.242,178.20.47.114,194.180.48.100,2.56.59.215,212.192.241.72,154.223.16.114,109.230.199.181,185.141.63.172,193.242.211.141,212.8.242.211,109.236.85.145,190.2.135.77,151.80.38.159,217.23.6.51,217.23.9.168,37.187.122.227,51.159.66.125,109.236.88.134,109.236.81.104,176.31.254.229,185.141.63.2,185.141.63.4,185.141.63.84,185.141.63.85,188.165.192.126,188.165.192.18,188.165.195.130,195.154.174.130,195.154.176.206,195.154.176.209,195.154.178.238,195.154.188.211,195.154.235.51,195.154.241.165,195.154.242.37,195.154.243.38,195.154.251.21,195.154.251.99,195.154.252.221,195.154.253.49,37.187.142.187,37.187.143.172,37.187.148.204,62.210.204.131,88.80.145.110,88.80.145.142,88.80.147.200,88.80.147.205,88.80.147.36,88.80.148.219,88.80.148.33,88.80.148.8,91.121.171.208,91.92.111.131,91.92.111.132,91.92.111.133,91.121.30.185,94.23.58.173,217.23.5.14,94.131.111.240,81.177.136.179,74.119.192.188,185.196.9.161,49.13.94.153,213.248.43.54,67.217.57.54,89.190.156.180,34.74.68.195,104.194.130.185,109.234.156.180,128.140.123.187,149.248.76.158,152.89.198.77,193.106.175.11,195.85.115.195,212.193.48.80,213.227.154.170,217.12.206.218,45.129.14.157,45.143.136.123,45.144.28.76,45.87.154.158,78.24.222.162,85.208.107.228,91.203.193.162,194.26.135.180,121.37.215.155,91.215.85.23,89.23.98.92,89.23.96.177,91.215.85.23,158.160.5.182,185.215.113.66,195.35.19.138,34.195.224.242,54.225.185.110,193.233.193.65,176.123.11.26,141.11.178.3,91.199.133.104,193.17.183.123,95.216.253.55,45.141.87.216,172.233.228.93,144.172.79.92,66.235.168.222,110.47.250.103,126.227.76.24,38.207.148.123,147.45.70.100,199.119.206.28,38.181.70.3,149.28.194.95,78.141.232.174,38.180.128.159,64.176.226.203,38.180.106.167,173.255.223.159,38.60.218.153,185.108.105.110,146.70.192.174,149.88.27.212,154.223.16.34,38.180.41.251,203.160.86.91,45.121.51.2,4.228.216.231,104.223.91.28,198.54.135.99,184.147.100.29,146.70.117.210,198.54.130.153,169.150.203.22,185.156.46.163,146.70.171.99,206.217.206.108,45.86.221.146,193.32.126.233,87.249.134.11,66.115.189.247,104.129.24.124,146.70.171.112,198.54.135.67,146.70.124.216,45.134.142.200,206.217.205.49,146.70.117.56,169.150.201.25,66.63.167.147,194.230.144.126,146.70.165.227,154.47.30.137,154.47.30.150,96.44.191.140,146.70.166.176,198.44.136.56,176.123.6.193,192.252.212.60,173.44.63.112,37.19.210.34,37.19.210.21,185.213.155.241,198.44.136.82,93.115.0.49,204.152.216.105,198.44.129.82,185.248.85.59,198.54.131.152,102.165.16.161,185.156.46.144,45.134.140.144,198.54.135.35,176.123.3.132,185.248.85.14,169.150.223.208,162.33.177.32,194.230.145.67,5.47.87.202,194.230.160.5,194.230.147.127,176.220.186.152,194.230.160.237,194.230.158.178,194.230.145.76,45.155.91.99,194.230.158.107,194.230.148.99,194.230.144.50,185.204.1.178,79.127.217.44,104.129.24.115,146.70.119.24,138.199.34.144,185.248.85.14,94.156.79.8,79.137.192.4,62.138.18.13,43.156.237.181,45.207.168.120,185.81.115.28,79.137.197.154,91.215.85.223,45.9.74.36,147.45.47.37,77.221.156.10,83.217.208.37,129.226.206.133,129.226.206.133,103.224.182.251,204.11.56.48,37.187.88.137,54.37.5.34,132.226.203.60,51.68.87.229,185.155.184.98,157.230.4.182,37.1.213.100,85.192.63.194,94.142.138.131,185.246.188.124,185.246.188.125,194.63.140.103,194.63.143.61,194.63.143.96,47.251.77.252,185.106.94.223,34.117.171.15,23.111.31.137,23.111.88.207,147.135.253.55


Write-Host "All rules should have been added to the Windows Firewall"
pause
